{"ast":null,"code":"import React,{useState}from\"react\";import\"../../css/login.css\";import{useLocation,useNavigate}from\"react-router-dom\";import hash from'hash.js';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function LoginOverlay(_ref){let{isOpen,onClose}=_ref;const[username,setUsername]=useState(\"\");const[password,setPassword]=useState(\"\");const[usernameError,setUsernameError]=useState(\"\");const[passwordError,setPasswordError]=useState(\"\");const[loginError,setLoginError]=useState(\"\");const location=useLocation();const navigate=useNavigate();function hashPassword(password){return hash.sha256().update(password).digest('hex');}const handleSubmit=e=>{e.preventDefault();if(username===\"\"){setUsernameError(\"Inserire il proprio username!\");}else{setUsernameError(\"\");}if(password===\"\"){setPasswordError(\"Inserire la propria password!\");}else{setPasswordError(\"\");}if(username&&password){let hashedPassword=hashPassword(password);const cred={user:username,pwd:hashedPassword};fetch(\"http://localhost:3000/verify_login\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(cred),credentials:\"include\"}).then(response=>response.json()).then(data=>{console.log(data);//OK\nif(data.Status===\"Success\"){onClose(true);navigate(\"/\");}else{console.log(data.Status);setLoginError(\"Autenticazione fallita\");}}).catch(error=>{console.error(error);});}};return/*#__PURE__*/_jsx(_Fragment,{children:isOpen?/*#__PURE__*/_jsxs(\"div\",{className:\"login-overlay\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"overlay_background\",onClick:onClose}),/*#__PURE__*/_jsxs(\"div\",{className:\"overlay_container\",children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"login-title\",children:[\"Accedi a \",/*#__PURE__*/_jsx(\"br\",{}),\" KnowHow\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control txt\",placeholder:\"Username\",value:username,onChange:event=>setUsername(event.target.value)}),usernameError&&/*#__PURE__*/_jsx(\"p\",{className:\"error-paragraph\",children:usernameError}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control pwd\",placeholder:\"Password\",value:password,onChange:event=>setPassword(event.target.value)}),passwordError&&/*#__PURE__*/_jsx(\"p\",{className:\"error-paragraph\",children:passwordError}),loginError&&/*#__PURE__*/_jsx(\"p\",{className:\"error-paragraph-auth\",children:loginError})]}),/*#__PURE__*/_jsx(\"div\",{className:\"centeredLink\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn-login-2\",type:\"button\",value:\"Submit\",onClick:handleSubmit,children:\"Accedi\"})})]})]}):null});}","map":{"version":3,"names":["React","useState","useLocation","useNavigate","hash","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","LoginOverlay","_ref","isOpen","onClose","username","setUsername","password","setPassword","usernameError","setUsernameError","passwordError","setPasswordError","loginError","setLoginError","location","navigate","hashPassword","sha256","update","digest","handleSubmit","e","preventDefault","hashedPassword","cred","user","pwd","fetch","method","headers","body","JSON","stringify","credentials","then","response","json","data","console","log","Status","catch","error","children","className","onClick","type","placeholder","value","onChange","event","target"],"sources":["/Users/matteofranchini/Documents/GitHub/piattaforma_tutoraggio/client/src/components/pages/login.js"],"sourcesContent":["import React, {useState} from \"react\";\nimport \"../../css/login.css\";\nimport {useLocation, useNavigate} from \"react-router-dom\";\nimport hash from 'hash.js';\n\nexport default function LoginOverlay ({isOpen, onClose}) {\n    const [username, setUsername] = useState(\"\");\n    const [password, setPassword] = useState(\"\");\n    const [usernameError, setUsernameError] = useState(\"\");\n    const [passwordError, setPasswordError] = useState(\"\");\n    const [loginError, setLoginError] = useState(\"\");\n    const location = useLocation();\n    const navigate = useNavigate();\n\n    function hashPassword(password) {\n        return hash.sha256().update(password).digest('hex');\n    }\n\n    const handleSubmit = (e) => {\n        e.preventDefault();\n\n        if(username === \"\"){\n            setUsernameError(\"Inserire il proprio username!\");\n        }else {\n            setUsernameError(\"\")\n        }\n\n        if(password === \"\"){\n            setPasswordError(\"Inserire la propria password!\");\n        }else {\n            setPasswordError(\"\");\n        }\n\n        if (username && password) {\n            let hashedPassword = hashPassword(password);\n            const cred = {\n                user: username,\n                pwd: hashedPassword,\n            }\n\n            fetch(\"http://localhost:3000/verify_login\", {\n                method: \"POST\",\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                },\n                body: JSON.stringify(cred),\n                credentials: \"include\",\n            })\n                .then((response) => response.json())\n                .then((data) => {\n                    console.log(data);\n\n                    //OK\n                    if(data.Status === \"Success\"){\n                        onClose(true);\n                        navigate(\"/\")\n                    }\n                    else {\n                        console.log(data.Status);\n                        setLoginError(\"Autenticazione fallita\");\n                    }\n                })\n                .catch((error) => {\n                    console.error(error);\n                });\n        }\n    }\n\n\n    return(\n        <>\n        {\n            isOpen ?  (\n                <div className=\"login-overlay\">\n                    <div className=\"overlay_background\" onClick={onClose}></div>\n                    <div className=\"overlay_container\">\n                        <h2 className=\"login-title\">Accedi a <br/> KnowHow</h2>\n                        <div className=\"input\">\n                            <input type=\"text\" className=\"form-control txt\" placeholder=\"Username\" value={username} onChange={(event) => setUsername(event.target.value)}/>\n                            {usernameError && <p className=\"error-paragraph\">{usernameError}</p>}\n                            <input type=\"password\" className=\"form-control pwd\" placeholder=\"Password\" value={password} onChange={(event) => setPassword(event.target.value)}/>\n                            {passwordError && <p className=\"error-paragraph\">{passwordError}</p>}\n                            {loginError && <p className=\"error-paragraph-auth\">{loginError}</p>}\n                        </div>\n                        <div className=\"centeredLink\">\n                            <button className=\"btn-login-2\" type=\"button\" value=\"Submit\" onClick={handleSubmit}>Accedi</button>\n                        </div>\n                    </div>\n                </div>\n            ) : null\n        }\n        </>\n    );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}